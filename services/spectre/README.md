# Сервис писем военных лет

## Описание проекта

Данный модуль представляет собой REST API CRUD-сервис. Он предназначен для работы с письмами военных лет, позволяя создавать, читать, обновлять и удалять записи этих исторических документов.

---

## Возможности

- **Создание**: Добавление новых писем в систему.
- **Чтение**: Получение и просмотр сохранённых писем.
- **Обновление**: Изменение существующих записей писем.
- **Удаление**: Удаление писем из системы.

---

## Структура модуля

- `cmd/` - Точка входа в приложение
    - `migrator/` - Приложение для создания или отката миграций
    - `spectre/` - Основное приложение
- `internal/` - Основная бизнес-логика и сервисы
    - `lib/` - Вспомогательные функции широкого назначения
    - `storage/` - Работа с файловой системой (базами данных)
        - `sqlite/` - Одна из реализаций базы (sqlite)
- `pkg/` - Общие утилиты и вспомогательные функции
    - `logger/` - Обертка вокруг логгера (logrus)
- `api/` - Апи поинты сервиса
    - `methods/` - Функции для унификации методов в роутере
    - `response/` - Описание ответа

---

## API эндпоинты

### Получить все письма

`GET /api/letters`

**Успех (200 OK):**
```json
{
  "data": [
    {
      "id": 1,
      "author": "Author1",
      "found_at": "2005-11-11T00:00:00Z",
      "found_in": "kek",
      "body": "body"
    },
    {
      "id": 2,
      "author": "Author2",
      "found_at": "2005-11-11T00:00:00Z",
      "found_in": "kek",
      "body": "body"
    }
  ],
  "error": null
}
```

**Ошибка (500 Internal Server Error):**
```json
{
  "data": null,
  "error": "error!"
}
```

---

### Получить письмо по ID

`GET /api/letters/{letter_id}`

**Успех (200 OK):**
```json
{
  "data": {
    "id": 1,
    "author": "Author3",
    "found_at": "2005-11-11T00:00:00Z",
    "found_in": "kek",
    "body": "body"
  },
  "error": null
}
```

**Ошибка (500 Internal Server Error):**
```json
{
  "data": null,
  "error": "error!"
}
```

---

### Удалить письмо по ID

`DELETE /api/letters/{letter_id}`

**Успех (200 OK):**
```json
{
  "data": null,
  "error": null
}
```

**Ошибка (500 Internal Server Error):**
```json
{
  "data": null,
  "error": "error!"
}
```

---

### Создать новое письмо

`POST /api/letters`

**Тело запроса (application/json):**
```json
{
  "author": "Author Name",
  "found_at": "2005-11-11T00:00:00Z",
  "found_in": "Место находки",
  "body": "Текст письма"
}
```

**Успех (200 OK):**
```json
{
  "data": null,
  "error": null
}
```

**Ошибка (422 | 400):**
```json
{
  "data": null,
  "error": "error!"
}
```

---

### Обновить письмо по ID

`PUT /api/letters/{letter_id}`

**Тело запроса (application/json):**
```json
{
  "author": "Новое имя автора",
  "found_at": "2024-05-17T00:00:00Z",
  "found_in": "Новое место находки",
  "body": "Обновлённый текст письма"
}
```

Важно - если указывать отдельные поля, например
```json
{
  "author": "Новое имя автора", 
}
```
значения остальных полей выставятся в значения по умолчанию, а не сохранятся прежними, то есть запись будет испорчена.

Для обновления конкретных полей должна использоваться ручка PATCH, но данное апи ее не предоставляет.

**Успех (200 OK):**
```json
{
  "data": null,
  "error": null
}
```

**Ошибка (500 | 400 | 404):**
```json
{
  "data": null,
  "error": "error!"
}
```
