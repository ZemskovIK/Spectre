# Сервис обеспечения криптографической безопасности

## Описание "модуля"

Данная директория состоит из криптографического модуля, который обладает всеми нужными функциями для обеспечения безопасности проекта, и серверного скрипта на Flask, который используется основным сервисом для шифрования и расшифрования данных. 

---

## Функциональность

- **AES-256-CBC-HMAC**: Для шифрования и расшифрования сервис использует современный стндарт шифрования AES-256 в режиме CBC с проверкой целостности данных с помощью HMAC.
- **ECDH**: Используется протокол Диффи-Хеллмана основанный на эллептических кривых (secp256r1).
- **Наличие nonce**: Добавление уникального идентификатора в каждое сообщение с целью защиты от повторных атак.
- **ECDSA**: Использование цифровых подписей на базе ECDSA для проверки подлинности
участников. (Еще не дореализовано)

---

## Описание модуля и сервера

### ECDHKeyExchange

Класс описывающий объект для работы с протоколом Диффи-Хеллмана на эллиптических кривых. При создании объекта сразу генерирует приватный ключ. Работает на основе кривой secp256r1(стр. 142).

`get_public_key_base64()`

Функция, которая вычисляет публичный ключ на основе приватного и возвращяет его в кодировке base64.

`compute_shared_secret()`

Функция, которая вычисляет общий секрет на основе собственного приватного ключа и публичного ключа другой стороны. 
Тут же реализована функция HKDF, вычисляющая AES и HMAC ключи из общего секрета.
На вход принимает публичный код другой стороны в кодировке base64. Ничего не возвращает, но вычисляет и сохраняет AES и HMAC ключи в чистом байтовом виде.

### Aes256CbcHmac

Класс описывающий объект для работы с конструкцией AES-CBC-HMAC(стр. 108).

`encrypt()`

Функция, задача которой состоит в том, чтобы зашифровать список данных и вернуть json-объект, который будет содержать всё необходимое, для получения исходных данных и проверки их целосности с помощью AES и HMAC ключей соответственно. 
На вход принимает исходные данные в виде строки байтов. Возвращает JSON-объект со следующими ключами: iv, content, nonce и hmac, значения каждого из которых будут в кодировке base64.

`decrypt()`

Функция, задача которой обратна encrypt(). Расшифровывает "content", используя "iv" и проверяет целостность данных с помощью "nonce" и "hmac".
На вход получает JSON-объект состоящий из полей с iv, content, nonce и hmac. Возвращает расшифрованные данные в виде строки байтов, либо ошибку в случае провала проверки целостности данных.


Для изучения материала использовалась книга Дэвида Вонга "Реальная криптография" — СПб.: Питер, 2024.